import{d as Z,r as m,c as d,w as U,Y as N,H as ee,V as te,C as u,D as n,I as l,z as f,O as _,L as b,M as k,K as h,u as t,N as p,J as E,ah as se,as as ne,a8 as ae,aj as oe,am as le,R as S,ad as ce,ag as re,ai as ie,a7 as ue,P as pe,at as de,au as _e,S as ge,af as me,ae as fe}from"./element-plus-qgwGTzxg.js";import{n as C,i as r,p as he}from"./utils-DWTWu0JZ.js";import{u as ye,c as ve,d as Ie}from"./mainAppView-035_X34S.js";import{F as be}from"./index-CXlIl4tL.js";import"./fontAwesomeLibrary--AcGPZoj.js";const ke={class:"main"},Ve=["id"],Be={class:"setting-group-title"},Ue={class:"slider-anchors"},Ee={key:0,class:"user-box"},Se=["href"],we={class:"info"},Te={class:"name"},xe={class:"bio"},Oe={class:"login"},Ae={key:1,class:"imagehosting-pilot-lamp"},Ce=Z({__name:"SettingsPanel",setup(Re){const e=ye(),w=ve(),T=m(null),R=d(()=>e.settings.repoName),L=d(()=>e.settings.repoBranch),x=Object.keys(e.settingsCategory),M=d(()=>e.settings.bucket),F=d(()=>e.settings.endpoint),K=d(()=>e.settings.region),D=d(()=>e.settings.accessKeyId),P=d(()=>e.settings.secretAccessKey),v=m(C.ready);U([M,F,K,D,P],async([c,a,y,I,B])=>{await C.init(c.value,a.value,y.value,I.value,B.value)?v.value=!0:v.value=!1});const V=m(!1),g=m({});N(async()=>{if(!r.ready){e.settingsUsage={themeName:!0,repoName:!1,repoBranch:!1,repoPath:!1,defaultFrontMatter:!0,dateTimeFormat:!0,editorDefaultMode:!0,editorMaxWidth:!0,editorTypewriterMode:!0,editorAutoSpace:!0,editorGfmAutoLink:!0,bucket:!1,endpoint:!1,region:!1,accessKeyId:!1,secretAccessKey:!1,rootUrl:!1,defaultImageLinkString:!1};return}e.selectInputOptions.repoName=m([]),(await r.getRepoNames()).forEach(y=>{e.selectInputOptions.repoName.push(y.name)}),O();const a=await r.getUserInfo();a&&(g.value=a)});const O=async()=>{e.selectInputOptions.repoBranch=m([]);const c=await r.getRepoBranches();c&&c.forEach(a=>{e.selectInputOptions.repoBranch.push(a.name)})};U(R,async()=>{if(!localStorage.getItem("access_token")){w.replace({name:"launch"});return}V.value=!0,he(),await O();const a=e.settings.repoBranch.value;e.selectInputOptions.repoBranch.includes(a)||e.selectInputOptions.repoBranch.length>0&&(e.settings.repoBranch.value=e.selectInputOptions.repoBranch[0],r.branch=e.settings.repoBranch.value),V.value=!1}),U(L,async()=>{r.branch=e.settings.repoBranch.value});const z=c=>{c.preventDefault()},j=()=>{me.confirm("确定要退出登录吗？","Warning",{confirmButtonText:"退出",cancelButtonText:"取消",type:"warning"}).then(()=>{localStorage.removeItem("access_token"),r.ready=!1,w.replace({name:"launch"})}).catch(()=>{fe({type:"info",message:"logout canceled"})})};return(c,a)=>{const y=ce,I=se,B=ne,A=ae,W=le,$=oe,q=re,G=ie,H=ue,J=pe,Y=de,Q=_e,X=te;return ee((n(),u("div",ke,[l("div",{class:"settings-box",ref_key:"containerRef",ref:T},[f(G,{"label-position":"top"},{default:_(()=>[(n(!0),u(b,null,k(t(x),i=>(n(),u("div",{class:"group",id:"group-"+i,key:i},[l("div",Be,h(i),1),(n(!0),u(b,null,k(t(e).settingsCategory[i],s=>(n(),p(q,{key:s},{label:_(()=>[l("div",null,[S(h(t(e).settingsInputLabels[s])+" ",1),f(y,{class:"box-item",effect:"dark",content:t(e).settingsInputDescriptions[s],"raw-content":"",placement:"right-start"},{default:_(()=>[f(t(be),{icon:["fas","circle-question"]})]),_:2},1032,["content"])])]),default:_(()=>[t(e).settingsInputTypes[s]===t(e).InputType.lineInput?(n(),p(I,{key:0,modelValue:t(e).settings[s],"onUpdate:modelValue":o=>t(e).settings[s]=o,disabled:!t(e).settingsUsage[s],spellcheck:"false"},null,8,["modelValue","onUpdate:modelValue","disabled"])):t(e).settingsInputTypes[s]===t(e).InputType.textInput?(n(),p(I,{key:1,modelValue:t(e).settings[s],"onUpdate:modelValue":o=>t(e).settings[s]=o,autosize:"",type:"textarea",placeholder:"Please input",spellcheck:"false",disabled:!t(e).settingsUsage[s]},null,8,["modelValue","onUpdate:modelValue","disabled"])):t(e).settingsInputTypes[s]===t(e).InputType.numberInput?(n(),p(B,{key:2,modelValue:t(e).settings[s],"onUpdate:modelValue":o=>t(e).settings[s]=o,disabled:!t(e).settingsUsage[s]},null,8,["modelValue","onUpdate:modelValue","disabled"])):t(e).settingsInputTypes[s]===t(e).InputType.booleanInput?(n(),p(A,{key:3,modelValue:t(e).settings[s],"onUpdate:modelValue":o=>t(e).settings[s]=o,disabled:!t(e).settingsUsage[s]},null,8,["modelValue","onUpdate:modelValue","disabled"])):t(e).settingsInputTypes[s]===t(e).InputType.selectInput?(n(),p($,{key:4,modelValue:t(e).settings[s],"onUpdate:modelValue":o=>t(e).settings[s]=o,disabled:!t(e).settingsUsage[s]},{default:_(()=>[(n(!0),u(b,null,k(t(e).selectInputOptions[s],o=>(n(),p(W,{key:String(o),label:String(o),value:String(o)},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","disabled"])):E("",!0)]),_:2},1024))),128))],8,Ve))),128))]),_:1}),a[0]||(a[0]=l("div",{style:{height:"100px"}},null,-1))],512),l("div",Ue,[t(r).ready?(n(),u("div",Ee,[l("a",{href:g.value.html_url,target:"_blank"},[f(H,{src:g.value.avatar_url+"&48"},null,8,["src"]),l("div",we,[l("div",Te,h(g.value.name),1),l("div",xe,h(g.value.bio),1),l("div",Oe,h(g.value.login),1)])],8,Se),f(J,{type:"danger",plain:"",style:{width:"100%"},onClick:j},{default:_(()=>a[1]||(a[1]=[S(" 退出登录 ")])),_:1})])):E("",!0),f(Q,{container:T.value,direction:"vertical",type:"default",offset:30,onClick:z},{default:_(()=>[(n(!0),u(b,null,k(t(x),i=>(n(),p(Y,{href:"#group-"+i,title:i,key:i},null,8,["href","title"]))),128))]),_:1},8,["container"]),t(r).ready?(n(),u("div",Ae,[l("div",{class:ge(`pilot-lamp ${v.value?"useable":"unuseable"}`)},null,2),S(" 图床 "+h(v.value?"可用":"不可用"),1)])):E("",!0)])])),[[X,V.value]])}}}),ze=Ie(Ce,[["__scopeId","data-v-6693e31f"]]);export{ze as default};
